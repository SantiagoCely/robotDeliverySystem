import { of } from "rxjs";
import { map } from 'rxjs/operators';
import { APP_VALIDATORS } from '../../const/app-validators.const';
import { FormProvider } from '../../util/form-provider';
export function baseAsyncValidator(configModel, validatorName) {
    return (control) => {
        configModel = configModel || {};
        if (configModel.validatorConfig) {
            if (FormProvider.ProcessRule(control, configModel)) {
                return configModel.validatorConfig.pipe(map(resolveConfig(configModel, validatorName, control)));
            }
            return of(null);
        }
        else
            return of(resolveConfig(configModel, validatorName, control)(configModel));
    };
}
function resolveConfig(configModel, validatorName, control) {
    return config => {
        let configClone = Object.assign(Object.assign(Object.assign({}, configModel), config), { expressionProcessed: true });
        return APP_VALIDATORS[validatorName](configClone)(control);
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzZS5hc3luYy52YWxpZGF0b3IuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wYWNrYWdlcy9yZWFjdGl2ZS1mb3JtLXZhbGlkYXRvcnMvcmVhY3RpdmUtZm9ybS12YWxpZGF0b3JzL2FzeW5jL2Jhc2UuYXN5bmMudmFsaWRhdG9yLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUtBLE9BQU8sRUFBYyxFQUFFLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDdEMsT0FBTyxFQUFFLEdBQUcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3JDLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxrQ0FBa0MsQ0FBQTtBQUNqRSxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFFeEQsTUFBTSxVQUFVLGtCQUFrQixDQUFDLFdBQWdCLEVBQUUsYUFBcUI7SUFDdEUsT0FBTyxDQUFDLE9BQXdCLEVBQXNDLEVBQUU7UUFDcEUsV0FBVyxHQUFHLFdBQVcsSUFBSSxFQUFFLENBQUM7UUFDaEMsSUFBSSxXQUFXLENBQUMsZUFBZSxFQUFFO1lBQzdCLElBQUksWUFBWSxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUUsV0FBVyxDQUFDLEVBQUU7Z0JBQ2hELE9BQXlCLFdBQVcsQ0FBQyxlQUFnQixDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsYUFBYSxDQUFDLFdBQVcsRUFBRSxhQUFhLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO2FBQ3ZIO1lBQ0QsT0FBTyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUM7U0FDbkI7O1lBRUcsT0FBTyxFQUFFLENBQUMsYUFBYSxDQUFDLFdBQVcsRUFBRSxhQUFhLEVBQUUsT0FBTyxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztJQUNuRixDQUFDLENBQUE7QUFDTCxDQUFDO0FBR0QsU0FBUyxhQUFhLENBQUMsV0FBZ0IsRUFBRSxhQUFxQixFQUFFLE9BQXdCO0lBQ3BGLE9BQU8sTUFBTSxDQUFDLEVBQUU7UUFDWixJQUFJLFdBQVcsaURBQVEsV0FBVyxHQUFLLE1BQU0sR0FBSSxFQUFDLG1CQUFtQixFQUFDLElBQUksRUFBRSxDQUFFLENBQUM7UUFDL0UsT0FBTyxjQUFjLENBQUMsYUFBYSxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUE7SUFDOUQsQ0FBQyxDQUFBO0FBQ0wsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgICBBYnN0cmFjdENvbnRyb2wsXHJcclxuICAgIEFzeW5jVmFsaWRhdG9yRm5cbn0gZnJvbSBcIkBhbmd1bGFyL2Zvcm1zXCI7XHJcbmltcG9ydCB7IE9ic2VydmFibGUsIG9mIH0gZnJvbSBcInJ4anNcIjtcclxuaW1wb3J0IHsgbWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQgeyBBUFBfVkFMSURBVE9SUyB9IGZyb20gJy4uLy4uL2NvbnN0L2FwcC12YWxpZGF0b3JzLmNvbnN0J1xyXG5pbXBvcnQgeyBGb3JtUHJvdmlkZXIgfSBmcm9tICcuLi8uLi91dGlsL2Zvcm0tcHJvdmlkZXInO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGJhc2VBc3luY1ZhbGlkYXRvcihjb25maWdNb2RlbDogYW55LCB2YWxpZGF0b3JOYW1lOiBzdHJpbmcpOiBBc3luY1ZhbGlkYXRvckZuIHtcclxuICAgIHJldHVybiAoY29udHJvbDogQWJzdHJhY3RDb250cm9sKTogT2JzZXJ2YWJsZTx7IFtrZXk6IHN0cmluZ106IGFueSB9PiA9PiB7XHJcbiAgICAgICAgY29uZmlnTW9kZWwgPSBjb25maWdNb2RlbCB8fCB7fTtcclxuICAgICAgICBpZiAoY29uZmlnTW9kZWwudmFsaWRhdG9yQ29uZmlnKSB7XHJcbiAgICAgICAgICAgIGlmIChGb3JtUHJvdmlkZXIuUHJvY2Vzc1J1bGUoY29udHJvbCwgY29uZmlnTW9kZWwpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gKDxPYnNlcnZhYmxlPGFueT4+Y29uZmlnTW9kZWwudmFsaWRhdG9yQ29uZmlnKS5waXBlKG1hcChyZXNvbHZlQ29uZmlnKGNvbmZpZ01vZGVsLCB2YWxpZGF0b3JOYW1lLCBjb250cm9sKSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBvZihudWxsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICByZXR1cm4gb2YocmVzb2x2ZUNvbmZpZyhjb25maWdNb2RlbCwgdmFsaWRhdG9yTmFtZSwgY29udHJvbCkoY29uZmlnTW9kZWwpKTtcclxuICAgIH1cclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIHJlc29sdmVDb25maWcoY29uZmlnTW9kZWw6IGFueSwgdmFsaWRhdG9yTmFtZTogc3RyaW5nLCBjb250cm9sOiBBYnN0cmFjdENvbnRyb2wpIHtcclxuICAgIHJldHVybiBjb25maWcgPT4ge1xyXG4gICAgICAgIGxldCBjb25maWdDbG9uZSA9IHsgLi4uY29uZmlnTW9kZWwsIC4uLmNvbmZpZywuLi57ZXhwcmVzc2lvblByb2Nlc3NlZDp0cnVlIH0gfTtcclxuICAgICAgICByZXR1cm4gQVBQX1ZBTElEQVRPUlNbdmFsaWRhdG9yTmFtZV0oY29uZmlnQ2xvbmUpKGNvbnRyb2wpXHJcbiAgICB9XHJcbn0iXX0=